version: v1
managed:
    enabled: true

    go_package_prefix:
        default: github.com/nova38/thesis/lib/go/gen
        except:
            - buf.build/googleapis/googleapis
            - buf.build/bufbuild/protovalidate

plugins:
    #  ccbio_v1

    - plugin: buf.build/protocolbuffers/go
      out: lib/go/gen
      opt:
          - paths=source_relative

    - plugin: go-hlf
      out: lib/go/gen
      opt: [paths=source_relative]

    - plugin: buf.build/bufbuild/validate-go
      out: lib/go/gen
      opt:
          - paths=source_relative

    - plugin: buf.build/community/mitchellh-go-json:v1.1.0
      out: lib/go/gen
      opt:
          - paths=source_relative
          - emit_defaults=true
          # - orig_name=true
          - enums_as_ints=true


    - plugin: buf.build/bufbuild/es:v1.3.1
      out: lib/es/hlf_tools/src/gen
      opt: target=ts

    - plugin: protoc-gen-es-hlf
      path: ["tsx", "tools/cmd/protoc-gen-es-hlf/src/main.ts"]
      opt: target=ts
      out: lib/es/hlf_tools/src/gen
      strategy: all

    - plugin: buf.build/grpc-ecosystem/openapiv2:v2.18.1
      out: lib/other/gen/openapiv2
      opt:
        - allow_merge=true
        - merge_file_name=cc_schema
        - generate_unbound_methods=true
        - disable_default_responses=true
        - json_names_for_fields=false
        # - simple_operation_ids=true


    - plugin: buf.build/community/pseudomuto-doc:v1.5.1
      out: lib/other/gen/doc
      opt:
        -  markdown,docs.md



      # opt: ["paths=source_relative"]

    #    out: lib/go/gen
    #    opt:
    #      - paths=source_relative



#    - plugin: buf.build/community/google-gnostic-openapi:v0.7.0
#      out: gen/gnostic
#      opt: [paths=source_relative]
